# SL-GPS
This repository contains the means to create a neural network architecture for dynamic chemistry reduction based on reduction results from Global Pathway Selection. 
## Creating an ANN
To produce a new ANN as an h5 file, run the main.py file. If the input parameter 'data_path' specified at the top of the file points to a pre-existing directory containing the state vector and reduced species data, an ANN will be trained to select a reduced set of species given a thermochemical state as input. If the data does not exist, a series of autoignition simulations will be run across a random set of initial conditions, and classic GPS will be run on the results to produce a set of data that is stored at the specified directory. The nature of these simulations is controlled by the other input parameters in main.py, including the fuel, detailed mechanism, ranges of initial temperatures, pressures, and equivalence ratios considered, the number of cases run, and the tolerance of GPS in including species ("alpha").

The architecture of the neural network defaults to one hidden layer with 16 neurons, but this can be changed in mech_train.py in the indicated section of code. Other hyperparameters of the training process can also be edited in this file, which uses the Python Keras API in Tensorflow 2. By default, a sigmoid activation function and binary crossentropy loss are used. An 80-20 training test split is performed and the model is trained until validation loss fails to improve for 20 epochs. The trained ANN is then stored as an h5 file in another directory specified in main.py. 

Please keep in mind that the ANN predicts the inclusion of only a subset of the detailed mechanism's species, while the remaining species are marked to be always or never included. These groups are indicated by the "var_spec_nums.csv," "always_spec_nums.csv," and "never_spec_nums.csv" respectively.
## Testing the ANN
This repository also allows the testing of an ANN adaptively reducing a mechanism using the SL_GPS method over the course of another autoignition simulation. This simulation can be run from the SL_GPS.py file. Another set of input parameters at the top of this file control the initial conditions, duration, and frequency of mechanism updates over the course of the simulation.
